<!-- index.html (premium-light — preserves your original IDs & script links) -->
<!DOCTYPE html>
<html lang="en">
<head>
  <!-- ====== Meta & Favicon ====== -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LP Sales & Insights</title>
  <link rel="icon" type="image/png" href="assets/favicon_io/favicon.ico">
  <!-- Notyf CSS & JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css">


  <!-- ====== Fonts ====== -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">

  <!-- ====== Tailwind CSS (dev CDN) ====== -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- ====== External Libraries (leave as your project expects) ====== -->
<script src="https://www.gstatic.com/firebasejs/10.10.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.10.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.10.0/firebase-auth-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
<script src="https://unpkg.com/feather-icons"></script>
<script src="https://cdn.jsdelivr.net/npm/dom-to-image@2.6.0/src/dom-to-image.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
<script src="https://unpkg.com/feather-icons"></script>



  <!-- ====== Visual polish (keeps your classes/IDs — only cosmetic) ====== -->
  <style>
    :root{
      --accent: #fdba74;
      --muted: #6b7280;
      --card-shadow: 0 10px 30px rgba(15,23,42,0.06);
      --glass-bg: rgba(255,255,255,0.7);
    }
    html,body { height:100%; font-family: 'Poppins', sans-serif; }

    /* Prevent sidebar nav text from wrapping */
#sidebar .nav-link .sidebar-label {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

    /* overall subtle gradient behind app, but keep bg-gray-50 fallback */
    body { background: linear-gradient(180deg,#ffffff 0%, #fbfbfd 45%, #fff6f0 100%); }

    /* nav link premium active */
    .nav-link.active {
      background: #c8aff0f2; /* Light purple */
      color: #1f2937;
      border-left: 4px solid var(--accent);
      font-weight: 600;
      border-radius: 0.6rem;
      box-shadow: 0 4px 18px rgba(253,186,116,0.09);
    }
    .nav-link {
  border-radius: 0.6rem; /* always rounded */
  transition: background 200ms ease, color 200ms ease, transform 150ms ease;
  color: #374151;
}
    .nav-link:hover {
      transform: translateY(-2px);  /* subtle lift on hover */
      background: #c8aff0f2; /* Light purple */
      color: #111827;
    }

    /* glass-card utility */
    .glass {
  background: linear-gradient(180deg, rgba(255,255,255,0.90), rgba(255,255,255,0.80));
  backdrop-filter: blur(2px);
  -webkit-backdrop-filter: blur(2px);
  border: 1px solid rgba(255,255,255,0.85);
  box-shadow: 0 4px 16px rgba(15,23,42,0.04);
  border-radius: 12px;
}




    /* subtle micro-animations for sections */
    .page-section { opacity:0; transform: translateY(8px); transition: opacity .36s ease, transform .36s ease; pointer-events:none; }
    .page-section.show { opacity:1; transform: translateY(0); pointer-events:auto; }

    /* loader */
    #loader { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); z-index:60; }

    .sidebar-collapsed {
  width: 4rem !important;
  min-width: 4rem !important;
  max-width: 4rem !important;
  transition: width 220ms cubic-bezier(.4,0,.2,1);
  overflow-x: hidden;
}
.sidebar-collapsed .sidebar-label {
  opacity: 0;
  width: 0;
  padding: 0 !important;
  margin: 0 !important;
  pointer-events: none;
  transition: opacity 180ms cubic-bezier(.4,0,.2,1);
  display: inline-block !important;
}
#sidebar {
  transition: width 220ms cubic-bezier(.4,0,.2,1);
}
#sidebar .nav-link {
  transition: padding 220ms cubic-bezier(.4,0,.2,1), background 200ms, color 200ms, transform 150ms;
}
.sidebar-collapsed .nav-link {
  justify-content: center;
  padding-left: 0.5rem;
  padding-right: 0.5rem;
  text-align: center;
}

    /* print styles: keep original rules working */
    @media print {
      body * { visibility: hidden; }
      #invoicePrintArea, #invoicePrintArea * { visibility: visible; }
      aside, .nav-link, .bg-white.shadow-sm.border-b,
      #addItemBtn, .deleteBtn, button[onclick="printInvoice()"] { display: none !important; }
    }

    /* responsive tweaks */
    @media (max-width: 768px) {
      #sidebar { transform: translateX(-100%); position:fixed; z-index:40; height:100vh; }
      #sidebar.open { transform: translateX(0); }
      #sidebarToggle { display:block !important; }
    }
    @media (min-width: 769px) {
      #sidebarToggle { display:none !important; }
    }

    /* signature font helper */
    .font-signature { font-family: 'Great Vibes', cursive; }

    /* top greeting smaller */
    #greetingText { font-weight:600; color:var(--muted); }

    /* small utility for subtle card hover */
    .card-hover:hover { transform: translateY(-4px); transition: transform 180ms ease; }

    /* Glassmorph background image effect */
#glass-bg {
  position: fixed;
  inset: 0;
  z-index: 0;
  width: 100vw;
  height: 100vh;
  background: url('assets/Backgrounds/BG 4.png') center/cover no-repeat;

  background-color: #fff6f0;
}

#glass-bg::after {
  content: "";
  position: absolute;
  inset: 0;
  background: rgba(255,255,255,0.70);
  backdrop-filter: blur(4px) saturate(120%);
  -webkit-backdrop-filter: blur(4px) saturate(120%);
  pointer-events: none;
}

  </style>

  <!-- ====== Success Sound ====== -->
  <audio id="successSound" src="assets/ding.wav" preload="auto"></audio>
</head>
<body class="bg-gray-50">

  <!-- ====== Glassmorph Background ====== -->
  <div id="glass-bg"></div>

  <!-- ================= SIGN IN PAGE OVERLAY ================= -->
  <div id="signInPage" class="fixed inset-0 z-50 flex flex-col items-center justify-center bg-gradient-to-br from-pink-50 to-pink-100">
    <div class="glass max-w-md w-full rounded-2xl px-7 py-10 flex flex-col items-center">
      <img src="assets/LP Logo.png" alt="Lush Patisserie" class="mb-5 h-20 w-20 rounded-full shadow" />
      <h1 class="text-3xl font-bold text-center text-gray-900 mb-1">Welcome to Lush Patisserie</h1>
      <p class="text-sm text-gray-600 mb-6 text-center">Sign in to access your sales, insights, and more.</p>

      <button id="signInGoogleBtn"
        class="flex items-center gap-3 bg-gray-900 hover:bg-gray-800 text-white px-6 py-3 rounded-lg text-lg font-semibold shadow transition">
        <!-- Google Icon SVG (kept inline for compatibility) -->
        <svg class="w-6 h-6" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g><path fill="#4285F4" d="M44.5 20H24v8.5h11.7C34.7 33.1 30.1 36 24 36c-6.6 0-12-5.4-12-12s5.4-12 12-12c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.5 5.1 29.6 3 24 3 12.4 3 3 12.4 3 24s9.4 21 21 21c10.5 0 20-7.6 20-21 0-1.3-.1-2.7-.3-4z"/><path fill="#34A853" d="M6.3 14.7l7 5.1C15.5 16.1 19.4 13 24 13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.5 5.1 29.6 3 24 3c-7.2 0-13.4 3.1-17.7 8.1z"/><path fill="#FBBC05" d="M24 45c5.6 0 10.5-1.9 14.3-5.1l-6.6-5.4C29.7 36.9 27 38 24 38c-6.1 0-10.7-2.9-13.7-7.1l-7 5.4C6.6 41.9 14.1 45 24 45z"/><path fill="#EA4335" d="M44.5 20H24v8.5h11.7c-1.1 3.1-4.1 5.5-7.7 5.5-4.6 0-8.4-3.8-8.4-8.5s3.8-8.5 8.4-8.5c2.5 0 4.7.9 6.3 2.4l6.4-6.4C38.1 7.1 31.5 4 24 4c-10.5 0-19 8.5-19 19s8.5 19 19 19c10.5 0 19-8.5 19-19 0-1.3-.1-2.7-.3-4z"/></g></svg>
        Sign in with Google
      </button>
    </div>
    <div class="mt-8 text-gray-400 text-xs">© 2025 Lush Patisserie</div>
  </div>

  <!-- ================= LOADER (SPINNER) ================= -->
  <div id="loader">
    <svg class="animate-spin h-8 w-8 text-orange-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
    </svg>
  </div>

  <!-- ================= GREETING BAR (TOP) ================= -->
  <div class="w-full flex justify-end items-center px-6 py-3 bg-white shadow-sm border-b">
    <p id="greetingText" class="text-sm text-gray-600 font-medium"></p>
  </div>

  <!-- ================= SIDEBAR NAVIGATION ================= -->
  <aside id="sidebar" style="background-color: #F7F5F2;" class="w-64 border-r border-orange-100 shadow-md p-4 flex flex-col h-screen fixed left-0 top-0 bottom-0 transition-all duration-300 overflow-y-auto z-40">
    
    <!-- Sidebar Overlay for Mobile -->
<div id="sidebarOverlay" class="fixed inset-0 bg-black bg-opacity-30 z-30 hidden md:hidden"></div>

    
    <!-- ====== Brand Logo & Sidebar Toggle ====== -->
    <div class="flex items-center space-x-2 mb-6 p-4">
      <button id="sidebarToggle" class="md:hidden text-2xl focus:outline-none" aria-label="Toggle sidebar">☰</button>
      <img id="brandLogo" src="assets/LP Logo.png" alt="Lush Patisserie" class="h-14 w-14 rounded-full bg-gray-100" />
      <div class="sidebar-label">
        <h2 class="text-xl font-bold text-gray-900">Lush Patisserie</h2>
        <p class="text-sm text-gray-900">Sales & Insights</p>
      </div>
    </div>
    <!-- ====== Navigation Links ====== -->
    <nav id="sidebarNav" class="flex-1 px-4 space-y-1 overflow-y-auto">
      <!-- OPERATIONS HEADING -->
       <hr class="my-4 border-t border-gray-300" />
      <div class="sidebar-label uppercase font-bold text-xs text-gray-400 mt-8 mb-4 tracking-widest">Operations</div>
      <!-- Each nav-link below is a section in the app -->
      <a href="#workLog" class="nav-link flex items-center gap-2 text-gray-700 px-3 py-2 group" data-tooltip="Work Log">
        <!-- Icon SVG -->
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
        </svg>
        <span class="sidebar-label">Work Log</span>
      </a>
    
      <a href="#dashboard" class="nav-link flex items-center gap-2 text-gray-700 px-3 py-2 group" data-tooltip="Dashboard">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6a7.5 7.5 0 1 0 7.5 7.5h-7.5V6Z" />
          <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 10.5H21A7.5 7.5 0 0 0 13.5 3v7.5Z" />
        </svg>
        <span class="sidebar-label">Dashboard</span>
      </a>
      <a href="#recipeCalculator" class="nav-link flex items-center gap-2 text-gray-700 px-3 py-2 group" data-tooltip="Recipe Calculator">
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 15.75V18m-7.5-6.75h.008v.008H8.25v-.008Zm0 2.25h.008v.008H8.25V13.5Zm0 2.25h.008v.008H8.25v-.008Zm0 2.25h.008v.008H8.25V18Zm2.498-6.75h.007v.008h-.007v-.008Zm0 2.25h.007v.008h-.007V13.5Zm0 2.25h.007v.008h-.007v-.008Zm0 2.25h.007v.008h-.007V18Zm2.504-6.75h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V13.5Zm0 2.25h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V18Zm2.498-6.75h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V13.5ZM8.25 6h7.5v2.25h-7.5V6ZM12 2.25c-1.892 0-3.758.11-5.593.322C5.307 2.7 4.5 3.65 4.5 4.757V19.5a2.25 2.25 0 0 0 2.25 2.25h10.5a2.25 2.25 0 0 0 2.25-2.25V4.757c0-1.108-.806-2.057-1.907-2.185A48.507 48.507 0 0 0 12 2.25Z" />
  </svg>
  <span class="sidebar-label">Recipe Calculator</span>
</a>

      <a href="#invoice" class="nav-link flex items-center gap-2 text-gray-700 px-3 py-2 group" data-tooltip="Invoice">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
        </svg>
        <span class="sidebar-label">Invoice</span>
      </a>
      <a href="#payments" class="nav-link flex items-center gap-2 text-gray-700 px-3 py-2 group" data-tooltip="Payments">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z" />
        </svg>
        <span class="sidebar-label">Payments</span>
      </a>
      <a href="#orders" class="nav-link flex items-center gap-2 text-gray-700 px-3 py-2 group" data-tooltip="Orders">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
        </svg>
        <span class="sidebar-label">Orders</span>
      </a>
      <hr class="my-4 border-t border-gray-300" />
      <!-- MANAGEMENT HEADING -->
      <div class="sidebar-label uppercase font-bold text-xs text-gray-400 mt-8 mb-4 tracking-widest">Management</div>
      <a href="#inventory" class="nav-link flex items-center gap-2 text-gray-700 px-3 py-2 group" data-tooltip="Inventory">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
        </svg>
        <span class="sidebar-label">Inventory</span>
      </a>
      <a href="#clients" class="nav-link flex items-center gap-2 text-gray-700 px-3 py-2 group" data-tooltip="Clients">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z" />
        </svg>
        <span class="sidebar-label">Clients</span>
      </a>
      <a href="#fixedExpenses" class="nav-link flex items-center gap-2 text-gray-700 px-3 py-2 group" data-tooltip="Fixed Expenses">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 8.25H9m6 3H9m3 6-3-3h1.5a3 3 0 1 0 0-6M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
        </svg>
        <span class="sidebar-label">Fixed Expenses</span>
      </a>
      <a href="#export" class="nav-link flex items-center gap-2 text-gray-700 px-3 py-2 group" data-tooltip="Export">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 16.5V9.75m0 0 3 3m-3-3-3 3M6.75 19.5a4.5 4.5 0 0 1-1.41-8.775 5.25 5.25 0 0 1 10.233-2.33 3 3 0 0 1 3.758 3.848A3.752 3.752 0 0 1 18 19.5H6.75Z" />
        </svg>
        <span class="sidebar-label">Export</span>
      </a>
    </nav>

    <!-- ====== Quick Add Button (Floating) ====== -->
<button id="quickAddBtn" class="fixed bottom-8 left-1/2 md:left-72 transform -translate-x-1/2 md:translate-x-0 z-50 bg-orange-600 text-white rounded-full shadow-lg w-12 h-12 flex items-center justify-center text-3xl hover:bg-orange-700 transition-all duration-200" title="Quick Add" style="display:none;">+</button>

    <!-- ====== User Info & Logout ====== -->
    <div id="userInfo" class="hidden items-center gap-2 p-4">
      <img id="userPhoto" class="h-8 w-8 rounded-full" src="" alt="User" />
      <span id="userName" class="text-sm font-medium"></span>
      <button id="logoutBtn" class="bg-gray-200 text-gray-700 px-2 py-1 rounded hover:bg-gray-300">Logout</button>
    </div>
  </aside>

  <!-- ================= AUTH SECTION (Header) ================= -->
  <div id="authSection" class="flex items-center gap-2 ml-auto mb-4">
    <button id="loginBtn" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Sign in with Google</button>
  </div>

  <!-- ================= MAIN CONTENT ================= -->
  <main class="md:pl-64 min-h-screen flex flex-col bg-gray-50">
    <!-- ====== Work Log Section (Batch Calculator & Daily Logs) ====== -->
    <div id="workLog" class="page-section w-full flex justify-center show">
      <div class="flex flex-col gap-8 w-full max-w-full px-2 md:px-8 py-6 md:py-10">

        <!-- ====== Batch Calculator ====== -->
        <section id="batchCalculator" class="flex-1 min-w-0 w-full glass rounded-xl p-2 sm:p-4 md:p-10 mb-8 lg:mb-0">

          <h2 class="text-2xl font-bold mb-4 text-orange-700">Batch Calculator</h2>
          <form class="space-y-8">
            <div>
              <label class="block text-lg font-medium mb-2" for="costPerUnit">Cost per Unit (₹)</label>
              <input id="costPerUnit" type="number" class="w-full px-3 py-3 md:px-5 md:py-4 border border-gray-300 rounded-lg text-lg focus:outline-none focus:ring-2 focus:ring-orange-400" />
            </div>
            <div>
              <label class="block text-lg font-medium mb-2" for="sellingPrice">Selling Price per Unit (₹)</label>
              <input id="sellingPrice" type="number" class="w-full px-3 py-3 md:px-5 md:py-4 border border-gray-300 rounded-lg text-lg focus:outline-none focus:ring-2 focus:ring-orange-400" />
            </div>
            <div>
              <label class="block text-lg font-medium mb-2" for="quantity">Quantity per Batch</label>
              <input id="quantity" type="number" class="w-full px-3 py-3 md:px-5 md:py-4 border border-gray-300 rounded-lg text-lg focus:outline-none focus:ring-2 focus:ring-orange-400" />
            </div>
            <div class="flex gap-4 mt-4 flex-col md:flex-row">
              <button type="button" class="flex-1 bg-orange-600 text-white py-4 rounded-lg text-lg font-semibold hover:bg-orange-700 transition">Calculate & Save</button>
              <button type="reset" class="flex-1 bg-gray-200 text-gray-700 py-4 rounded-lg text-lg font-semibold hover:bg-gray-300 transition">Reset</button>
            </div>
          </form>
          <!-- ====== Batch Calculator Results ====== -->
          <div class="mt-10 space-y-4">
            <div class="flex justify-between text-lg">
              <span>Total Revenue:</span>
              <span id="totalRevenue" class="font-semibold text-orange-700">₹0.00</span>
            </div>
            <div class="flex justify-between text-lg">
              <span>Total Cost:</span>
              <span id="totalCost" class="font-semibold text-orange-700">₹0.00</span>
            </div>
            <div class="flex justify-between text-lg">
              <span>Gross Profit:</span>
              <span id="grossProfit" class="font-semibold text-orange-700">₹0.00</span>
            </div>
            <div class="flex justify-between text-lg">
              <span>Profit Margin:</span>
              <span id="profitMargin" class="font-semibold text-orange-700">0.00%</span>
            </div>
          </div>
          <!-- ====== Common Batches List ====== -->
          <div class="mt-12">
            <h3 class="text-lg font-semibold mb-4 text-orange-600">Common Batches</h3>
            <div class="space-y-4">
              <!-- Example Batch 1 -->
              <div class="flex items-center justify-between bg-orange-50 rounded-lg px-5 py-4">
                <div>
                  <div class="font-bold">Lassi Shop</div>
                  <div class="text-base text-gray-600">Cost: ₹30 | Price: ₹45 | Qty: 12</div>
                </div>
                <div class="flex gap-2">
                  <button class="bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 text-sm">Apply</button>
                  <button class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 text-sm">Delete</button>
                </div>
              </div>
              <!-- Example Batch 2 -->
              <div class="flex items-center justify-between bg-orange-50 rounded-lg px-5 py-4">
                <div>
                  <div class="font-bold">GK - 36 Brownie</div>
                  <div class="text-base text-gray-600">Cost: ₹30 | Price: ₹45 | Qty: 36</div>
                </div>
                <div class="flex gap-2">
                  <button class="bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 text-sm">Apply</button>
                  <button class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 text-sm">Delete</button>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- ====== Daily Logs Section ====== -->
        <section id="dailyLog" class="flex-1 min-w-0 w-full glass rounded-xl p-2 sm:p-4 md:p-10 space-y-6">

          <h2 class="text-xl sm:text-2xl md:text-4xl font-extrabold mb-6 text-orange-800 tracking-tight">Daily Logs</h2>

          <form class="space-y-8">
            <div>
              <label class="block text-lg font-medium mb-2" for="logDate">Date</label>
              <input id="logDate" type="date" class="w-full px-3 py-3 md:px-5 md:py-4 border border-gray-300 rounded-lg text-lg focus:outline-none focus:ring-2 focus:ring-orange-400" value="2025-06-20" />
            </div>
            <div class="flex flex-col md:flex-row gap-6">
              <div class="flex-1">
                <label class="block text-lg font-medium mb-2" for="clientName">Client/Order Name</label>
                <input id="clientName" type="text" class="w-full px-3 py-3 md:px-5 md:py-4 border border-gray-300 rounded-lg text-lg focus:outline-none focus:ring-2 focus:ring-orange-400" />
              </div>
              <div class="flex-1">
                <label class="block text-lg font-medium mb-2" for="item">Item</label>
                <input id="item" type="text" class="w-full px-3 py-3 md:px-5 md:py-4 border border-gray-300 rounded-lg text-lg focus:outline-none focus:ring-2 focus:ring-orange-400" />
              </div>
            </div>
            <div class="flex flex-col md:flex-row gap-6">
              <div class="flex-1">
                <label class="block text-lg font-medium mb-2" for="itemQty">Quantity</label>
                <input id="itemQty" type="number" class="w-full px-3 py-3 md:px-5 md:py-4 border border-gray-300 rounded-lg text-lg focus:outline-none focus:ring-2 focus:ring-orange-400" />
              </div>
              <div class="flex-1">
                <label class="block text-lg font-medium mb-2" for="revenue">Revenue (₹)</label>
                <input id="revenue" type="number" class="w-full px-3 py-3 md:px-5 md:py-4 border border-gray-300 rounded-lg text-lg focus:outline-none focus:ring-2 focus:ring-orange-400" />
              </div>
              <div class="flex-1">
                <label class="block text-lg font-medium mb-2" for="ingredients">Ingredients (₹)</label>
                <input id="ingredients" type="number" class="w-full px-3 py-3 md:px-5 md:py-4 border border-gray-300 rounded-lg text-lg focus:outline-none focus:ring-2 focus:ring-orange-400" />
              </div>
              <div class="flex-1">
                <label class="block text-lg font-medium mb-2" for="packaging">Packaging (₹)</label>
                <input id="packaging" type="number" class="w-full px-3 py-3 md:px-5 md:py-4 border border-gray-300 rounded-lg text-lg focus:outline-none focus:ring-2 focus:ring-orange-400" />
              </div>
            </div>
            <div class="flex gap-4 mt-4 flex-col md:flex-row">
              <button type="button" class="flex-1 bg-orange-600 text-white py-4 rounded-lg text-lg font-semibold hover:bg-orange-700 transition">+ Add Item</button>
              <button type="button" class="flex-1 bg-orange-100 text-orange-700 py-4 rounded-lg text-lg font-semibold hover:bg-orange-200 transition">Show Notes</button>
            </div>
          </form>

          <!-- ====== Daily Log Totals ====== -->
          <div class="mt-10">
            <div class="flex justify-between text-lg mb-2">
              <span>Total Revenue:</span>
              <span id="totalRevenueLog" class="font-semibold text-orange-700">₹0.00</span>
            </div>
            <div class="flex justify-between text-lg mb-2">
              <span>Total Cost:</span>
              <span id="totalCostLog" class="font-semibold text-amber-600">₹0.00</span>
            </div>
            <div class="flex justify-between text-lg mb-2">
              <span>Total Profit:</span>
              <span id="totalProfitLog" class="font-semibold text-green-600">₹0.00</span>
            </div>
            <div class="flex justify-between text-lg mb-2">
              <span>Calculated Profit:</span>
              <span id="calculatedProfit" class="font-semibold text-orange-700">₹0.00</span>
            </div>
            <div class="text-gray-500 text-base mt-4">
              <strong>Entries for 2025-06-20:</strong> No entries found for this date.
            </div>
          </div>

          <!-- ====== Daily Log Action Buttons ====== -->
          <div class="flex gap-4 mt-4 flex-col md:flex-row">
            <button type="button" class="flex-1 bg-orange-600 text-white py-4 rounded-lg text-lg font-semibold hover:bg-orange-700 transition">+ Add Item</button>
            <button type="button" class="flex-1 border-2 border-orange-600 text-orange-700 bg-white py-4 rounded-lg text-lg font-semibold hover:bg-orange-50 transition">Calculated Profit</button>
          </div>
        </section>
      </div>
    </div>

    <!-- ====== Other Sections (hidden by default, shown on nav) ====== -->
    <div id="dashboard" class="page-section hidden"></div>
<div id="fixedExpenses" class="page-section hidden"></div>
<div id="inventory" class="page-section hidden"></div>
<div id="export" class="page-section hidden"></div>
<div id="clients" class="page-section hidden"></div>
<div id="invoice" class="page-section hidden">
  <div id="invoicePrintArea"></div>
</div>
<div id="payments" class="page-section hidden"></div>
<div id="orders" class="page-section hidden"></div>


<!-- Ingredient Manager & Recipe Calculator Section -->

<!-- Sleek Recipe Calculator UI -->
<div id="recipeCalculator" class="page-section hidden w-full">
  <div class="w-full glass rounded-xl p-6 mt-8 flex flex-col gap-10">
    <!-- Top Section: Calculator | Calculation Summary | Final Summary -->
    <div class="flex flex-col md:flex-row gap-6 w-full">
      <!-- Recipe Calculator Form -->
      <form id="recipeForm" class="flex-1 space-y-4 bg-white border border-slate-200 rounded-xl shadow-sm p-4 w-full">
        <h2 class="text-lg font-semibold text-slate-700 text-center mb-2">Recipe Calculator</h2>
        <div>
          <label for="ingredientSelect" class="block text-base font-medium mb-1">Ingredient</label>
          <select id="ingredientSelect" class="w-full px-2 py-2 border border-slate-300 rounded-md text-base focus:outline-none focus:ring-1 focus:ring-slate-400">
            <option value="">Select ingredient</option>
          </select>
        </div>
        <div>
          <label for="usedAmount" class="block text-base font-medium mb-1">Amount Used</label>
          <input id="usedAmount" type="number" min="0" class="w-full px-2 py-2 border border-slate-300 rounded-md text-base focus:outline-none focus:ring-1 focus:ring-slate-400" />
        </div>
        <div>
          <label for="usedUnit" class="block text-base font-medium mb-1">Unit</label>
          <select id="usedUnit" class="w-full px-2 py-2 border border-slate-300 rounded-md text-base focus:outline-none focus:ring-1 focus:ring-slate-400">
            <option value="">Select unit</option>
          </select>
        </div>
        <div class="flex justify-center mt-2 gap-2">
          <button type="button" id="calcBtn" class="bg-slate-600 text-white px-4 py-2 rounded-md text-base font-medium hover:bg-slate-700 transition">Calculate Cost</button>
          <button type="button" id="resetCalcBtn" class="bg-slate-200 text-slate-700 px-4 py-2 rounded-md text-base font-medium hover:bg-slate-300 transition">Reset</button>
        </div>
      </form>

      <!-- Calculation Summary Table -->
      <div class="flex-1 bg-white border border-slate-200 rounded-xl shadow-sm p-4 w-full">
  <h2 class="text-lg font-semibold text-slate-700 text-center mb-2">Calculation Summary</h3>
  <div class="overflow-x-auto">
    <table class="min-w-full bg-white rounded-md shadow-sm">
      <thead>
        <tr class="bg-slate-100">
          <th class="py-2 px-3 text-left text-slate-500 font-medium">Ingredient</th>
          <th class="py-2 px-3 text-left text-slate-500 font-medium">Amount</th>
          <th class="py-2 px-3 text-left text-slate-500 font-medium">Unit</th>
          <th class="py-2 px-3 text-left text-slate-500 font-medium">Cost (₹)</th>
          <th class="py-2 px-3 text-left text-slate-500 font-medium">Actions</th>
        </tr>
      </thead>
      <tbody id="costTableBody">
        <!-- Calculated rows will appear here -->
      </tbody>
    </table>
  </div>
  <!-- This is the correct place for the total cost display -->
  <div id="calcSummaryTotal" class="mt-4 text-center"></div>
</div>


      <!-- Final Summary -->
      <div class="flex-1 bg-white border border-slate-200 rounded-xl shadow-sm p-4 flex flex-col justify-center w-full">
        <h2 class="text-lg font-semibold text-slate-700 text-center mb-2">Final Summary</h3>
        <div class="space-y-2">
          <div>
            <label for="labourCost" class="block text-sm font-medium mb-1">Labour Cost (₹)</label>
            <input id="labourCost" type="number" value="0" min="0" class="w-full px-2 py-2 border border-slate-300 rounded-md text-base focus:outline-none focus:ring-1 focus:ring-slate-400" />
          </div>
          <div>
            <label for="maintenanceCost" class="block text-sm font-medium mb-1">Maintenance (₹)</label>
            <input id="maintenanceCost" type="number" value="0" min="0" class="w-full px-2 py-2 border border-slate-300 rounded-md text-base focus:outline-none focus:ring-1 focus:ring-slate-400" />
          </div>
          <div>
            <label for="licensingCost" class="block text-sm font-medium mb-1">Licensing (₹)</label>
            <input id="licensingCost" type="number" value="0" min="0" class="w-full px-2 py-2 border border-slate-300 rounded-md text-base focus:outline-none focus:ring-1 focus:ring-slate-400" />
          </div>
          <div>
            <label for="packagingCost" class="block text-sm font-medium mb-1">Packaging (₹)</label>
            <input id="packagingCost" type="number" value="0" min="0" class="w-full px-2 py-2 border border-slate-300 rounded-md text-base focus:outline-none focus:ring-1 focus:ring-slate-400" />
          </div>
          <div>
            <label for="electricityCost" class="block text-sm font-medium mb-1">Electricity (₹)</label>
            <input id="electricityCost" type="number" value="0" min="0" class="w-full px-2 py-2 border border-slate-300 rounded-md text-base focus:outline-none focus:ring-1 focus:ring-slate-400" />
          </div>
          <div>
            <label for="profitPercent" class="block text-sm font-medium mb-1">Profit %</label>
            <input id="profitPercent" type="number" value="0" min="0" class="w-full px-2 py-2 border border-slate-300 rounded-md text-base focus:outline-none focus:ring-1 focus:ring-slate-400" />
          </div>
        </div>
        <div class="mt-3 text-center flex gap-2 justify-center">
          <button type="button" id="calcFinalBtn" class="bg-slate-600 text-white px-4 py-2 rounded-md text-base font-medium hover:bg-slate-700 transition">Calculate Final Cost</button>
          <button type="button" id="resetFinalBtn" class="bg-slate-200 text-slate-700 px-4 py-2 rounded-md text-base font-medium hover:bg-slate-300 transition">Reset</button>
        </div>
        <div id="finalSummary" class="mt-4 text-center text-lg font-semibold text-slate-700"></div>
      </div>
    </div>

   <!-- Bottom Section: Add Ingredient | Saved Ingredients -->
<div class="flex flex-col md:flex-row gap-8">
  <!-- ================= Add/Edit Ingredient Form ================= -->
  <form id="addEditIngredientForm" class="flex-1 space-y-5 bg-white rounded-xl shadow p-6">
    <!-- Heading changes to "Edit Ingredient" when editing -->
    <h2 id="ingredientFormTitle" class="text-lg font-semibold text-slate-700 text-center mb-2">Add Ingredient</h2>
    <div>
      <label for="ingredientName" class="block text-base font-medium mb-1 text-slate-600">Ingredient Name</label>
      <input
        id="ingredientName"
        type="text"
        placeholder="e.g. Cocoa Powder"
        class="w-full px-4 py-2 border border-slate-300 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-indigo-400 transition-all duration-150 shadow-sm"
      />
    </div>
    <div>
      <label for="ingredientCost" class="block text-base font-medium mb-1 text-slate-600">Package Cost (₹)</label>
      <input
        id="ingredientCost"
        type="number"
        placeholder="e.g. 250"
        class="w-full px-4 py-2 border border-slate-300 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-indigo-400 transition-all duration-150 shadow-sm"
      />
    </div>
    <div>
      <label for="ingredientSize" class="block text-base font-medium mb-1 text-slate-600">Package Size</label>
      <input
        id="ingredientSize"
        type="number"
        placeholder="e.g. 500"
        class="w-full px-4 py-2 border border-slate-300 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-indigo-400 transition-all duration-150 shadow-sm"
      />
    </div>
    <div>
      <label for="ingredientUnit" class="block text-base font-medium mb-1 text-slate-600">Unit</label>
      <select
        id="ingredientUnit"
        class="w-full px-4 py-2 border border-slate-300 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-indigo-400 transition-all duration-150 shadow-sm"
      >
        <option value="">Select unit</option>
        <option value="g">g</option>
        <option value="kg">kg</option>
        <option value="ml">ml</option>
        <option value="L">L</option>
      </select>
    </div>
    <div class="flex justify-center gap-4 mt-2">
      <!-- Button label changes to "Update Ingredient" when editing -->
      <button id="ingredientFormBtn" class="bg-slate-600 text-white px-6 py-2 rounded-md text-base font-medium hover:bg-slate-700 transition">Add Ingredient</button>
      <!-- Cancel button only shows when editing -->
      <button type="button" id="cancelEditBtn" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-md text-base font-medium hover:bg-gray-300 transition" style="display:none;">Cancel</button>
    </div>
  </form>

  <!-- ================= Saved Ingredients Table ================= -->
  <div class="flex-1 bg-white rounded-xl shadow p-6">
    <h2 class="text-lg font-semibold text-slate-700 text-center mb-2">Saved Ingredients</h2>
    <div class="overflow-x-auto">
  <table class="min-w-full bg-white rounded-lg shadow">
        <thead>
  <tr class="bg-indigo-50">
    <th class="py-2 px-4 text-left">Name</th>
    <th class="py-2 px-4 text-left hidden sm:table-cell">Size</th>
    <th class="py-2 px-4 text-left hidden sm:table-cell">Unit</th>
    <th class="py-2 px-4 text-left">Cost (₹)</th>
    <th class="py-2 px-4 text-left">Actions</th>
  </tr>
</thead>

        <tbody id="ingredientsTableBody">
          <!-- Ingredients will be listed here by JS -->
        </tbody>
      </table>
    </div>
    <!--
      Actions:
      - Edit: Loads ingredient into the form, changes form to "Update Ingredient" mode.
      - Delete: Removes ingredient from Firestore and updates the table.
    -->
  </div>
</div>



  </main>

  <!-- ================= SCRIPTS ================= -->

  <!-- ====== Greeting Bar Script (keeps behavior) ====== -->
  <script>
    function getGreeting() {
      const hour = new Date().getHours();
      if (hour < 12) return "Good morning";
      if (hour < 18) return "Good afternoon";
      return "Good evening";
    }
    document.addEventListener("DOMContentLoaded", () => {
      const greetingEl = document.getElementById("greetingText");
      if (greetingEl) greetingEl.textContent = `${getGreeting()}, Karthick!`;
      // feather icons (if any) — safe to call
      if (typeof feather !== 'undefined') try { feather.replace(); } catch(e){/* no-op */ }
    });
  </script>

  <!-- ====== App Feature Scripts (unchanged file names — your original files) ====== -->
  <script src="js/firebase.js"></script>
  <script src="js/batch.js"></script>
  <script src="js/dailyLog.js"></script>
  <script src="js/dashboard.js"></script>
  <script src="js/calculations.js"></script>
  <script src="js/inventory.js"></script>
  <script src="js/clients.js"></script>
  <script src="js/invoices.js"></script>
  <script src="js/payments.js"></script>
  <script src="js/orders.js"></script>

  <script>
  // Firestore setup
  const db = window.firebase.firestore();

  // Add ingredient to Firestore
  document.getElementById("addIngredientForm").addEventListener("submit", async function(e) {
    e.preventDefault();
    const name = document.getElementById("ingredientName").value.trim();
    const cost = parseFloat(document.getElementById("ingredientCost").value);
    const size = parseFloat(document.getElementById("ingredientSize").value);
    const unit = document.getElementById("ingredientUnit").value;
    if (!name || isNaN(cost) || isNaN(size) || !unit) {
      alert("Please fill all fields.");
      return;
    }
    await db.collection("ingredients").add({
      name, packageCost: cost, packageSize: size, packageUnit: unit,
      allowedUnits: unit === "g" || unit === "kg" ? ["g", "kg"] : ["ml", "L"]
    });
    document.getElementById("addIngredientForm").reset();
    loadIngredients();
  });

  // Load ingredients from Firestore and show in table & dropdown
  async function loadIngredients() {
    const snapshot = await db.collection("ingredients").get();
    const tableBody = document.getElementById("ingredientsTableBody");
    const select = document.getElementById("ingredientSelect");
    tableBody.innerHTML = "";
    select.innerHTML = '<option value="">Select ingredient</option>';
    window.BakingCalculator.ingredients = [];
    snapshot.forEach(doc => {
      const ing = doc.data();
      ing.id = doc.id;
      window.BakingCalculator.ingredients.push(ing);
      // Table row
      const tr = document.createElement("tr");
     tr.innerHTML = `
  <td class="py-2 px-4">${ing.name}</td>
  <td class="py-2 px-4 hidden sm:table-cell">${ing.packageSize}</td>
  <td class="py-2 px-4 hidden sm:table-cell">${ing.packageUnit}</td>
  <td class="py-2 px-4">${ing.packageCost}</td>
  <td class="py-2 px-4">
    <button class="deleteBtn bg-red-500 text-white px-2 py-1 rounded" data-id="${ing.id}">Delete</button>
  </td>
`;

      tableBody.appendChild(tr);
      // Dropdown option
      const opt = document.createElement("option");
      opt.value = ing.name;
      opt.textContent = ing.name;
      select.appendChild(opt);
    });
    // Delete logic
    document.querySelectorAll(".deleteBtn").forEach(btn => {
      btn.onclick = async function() {
        await db.collection("ingredients").doc(btn.getAttribute("data-id")).delete();
        loadIngredients();
      };
    });
  }

  // Allowed units logic for calculator
  document.getElementById("ingredientSelect").addEventListener("change", function() {
    const units = window.BakingCalculator.getAllowedUnits(this.value);
    const unitSelect = document.getElementById("usedUnit");
    unitSelect.innerHTML = '<option value="">Select unit</option>';
    units.forEach(u => {
      const opt = document.createElement("option");
      opt.value = u;
      opt.textContent = u;
      unitSelect.appendChild(opt);
    });
  });

  // Calculate cost
  document.getElementById("calcBtn").addEventListener("click", function() {
  const name = document.getElementById("ingredientSelect").value;
  const amount = parseFloat(document.getElementById("usedAmount").value);
  const unit = document.getElementById("usedUnit").value;
  const resultDiv = document.getElementById("calcResult");
  if (!name || isNaN(amount) || !unit) {
    resultDiv.innerHTML = `<div class="bg-red-50 text-red-700 rounded-lg px-6 py-4 font-semibold shadow text-center">Please fill all fields.</div>`;
    return;
  }
  const cost = window.BakingCalculator.calculateCost(name, amount, unit);
  resultDiv.innerHTML = `
    <div class="bg-indigo-50 text-indigo-700 rounded-lg px-6 py-4 font-semibold shadow text-center">
      Cost for <span class="font-bold">${amount} ${unit}</span> of <span class="font-bold">${name}</span>: 
      <span class="text-indigo-900 text-xl font-extrabold">₹${cost}</span>
    </div>
  `;
});


  // Initial load
  document.addEventListener("DOMContentLoaded", loadIngredients);
</script>


  <!-- ====== Section Navigation & Sidebar Logic (keeps your original logic) ====== -->
  <script>
    // List of all main sections
    const sections = ["workLog", "dashboard", "fixedExpenses", "inventory", "export", "clients", "invoice", "payments", "orders", "recipeCalculator"];

    // Show/hide loader spinner
    function toggleLoader(show) {
      const loader = document.getElementById("loader");
      loader.style.display = show ? "block" : "none";
    }

    // Highlight active nav link
    function setActiveNav(target) {
      document.querySelectorAll(".nav-link").forEach(link => link.classList.remove("active"));
      document.querySelector(`.nav-link[href='#${target}']`)?.classList.add("active");
    }

    // Show the selected section, hide others
    function showSection(target) {
      toggleLoader(true);
      sections.forEach(id => {
        const el = document.getElementById(id);
        if (el && !el.classList.contains("hidden")) {
          el.classList.remove("show");
          el.classList.add("fade-out");
          setTimeout(() => {
            el.classList.add("hidden");
            el.classList.remove("fade-out");
          }, 400);
        }
      });
      const targetEl = document.getElementById(target);
      if (targetEl) {
        targetEl.classList.remove("hidden");
        void targetEl.offsetWidth;
        setTimeout(() => {
          targetEl.classList.add("show");
          if (target === "payments" && typeof renderPaymentsTable === "function") {
            renderPaymentsTable();
          }
          if (target === "clients" && typeof renderClientsSection === "function") {
  renderClientsSection();
}
          toggleLoader(false);
          const main = document.querySelector('main');
          if (main) {
            main.scrollTop = 0;
          }
          window.scrollTo({ top: 0, behavior: "auto" });
        }, 30);
      } else {
        toggleLoader(false);
      }
    }

    // Sidebar nav link click: show section
    document.querySelectorAll("#sidebarNav .nav-link").forEach(link => {
      link.addEventListener("click", e => {
        const target = link.getAttribute("href").substring(1);
        e.preventDefault();
        showSection(target);
        setActiveNav(target);
        if (target === "dashboard" && typeof loadDashboard === "function") loadDashboard();
      });
    });

    // On page load, show workLog section
    window.addEventListener("DOMContentLoaded", () => {
      setActiveNav("workLog");
      showSection("workLog");
    });

    // Sidebar toggle/collapse logic
  const sidebarOverlay = document.getElementById("sidebarOverlay");
sidebarToggle?.addEventListener("click", () => {
  if (window.innerWidth < 769) {
    sidebar.classList.toggle("open");
    sidebarOverlay.classList.toggle("hidden", !sidebar.classList.contains("open"));
  } else {
    isCollapsed = !isCollapsed;
    sidebar.classList.toggle("sidebar-collapsed", isCollapsed);
    document.getElementById("quickAddBtn").style.display = isCollapsed ? "none" : "block";
  }
});
sidebarOverlay.addEventListener("click", () => {
  sidebar.classList.remove("open");
  sidebarOverlay.classList.add("hidden");
});


    // Tooltips for icons when sidebar is collapsed
    document.querySelectorAll("#sidebarNav .nav-link").forEach(link => {
      link.addEventListener("mouseenter", function () {
        if (sidebar.classList.contains("sidebar-collapsed")) {
          const tooltip = document.createElement("div");
          tooltip.className = "fixed left-16 bg-black text-white text-xs rounded px-2 py-1 z-50";
          tooltip.style.top = (link.getBoundingClientRect().top + window.scrollY) + "px";
          tooltip.innerText = link.getAttribute("data-tooltip");
          tooltip.id = "sidebar-tooltip";
          document.body.appendChild(tooltip);
        }
      });
      link.addEventListener("mouseleave", function () {
        document.getElementById("sidebar-tooltip")?.remove();
      });
    });

    // Quick Add Button: opens invoice section
    const quickAddBtn = document.getElementById("quickAddBtn");
    quickAddBtn.style.display = "block";
    quickAddBtn.addEventListener("click", () => {
      showSection("invoice");
      setActiveNav("invoice");
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    // Dark mode toggle (if you add a button with id="toggleDark")
    const darkBtn = document.getElementById("toggleDark");
    darkBtn?.addEventListener("click", () => {
      document.body.classList.toggle("dark");
      if (document.body.classList.contains("dark")) {
        document.body.classList.add("bg-gray-900", "text-white");
        sidebar.classList.add("bg-gray-900");
      } else {
        document.body.classList.remove("bg-gray-900", "text-white");
        sidebar.classList.remove("bg-gray-900");
      }
    });

    // Keyboard navigation for sidebar (Arrow keys)
    sidebar.addEventListener("keydown", e => {
      const links = Array.from(document.querySelectorAll("#sidebarNav .nav-link"));
      const idx = links.indexOf(document.activeElement);
      if (e.key === "ArrowDown") {
        e.preventDefault();
        links[(idx + 1) % links.length].focus();
      } else if (e.key === "ArrowUp") {
        e.preventDefault();
        links[(idx - 1 + links.length) % links.length].focus();
      }
    });

    // Responsive: close sidebar on mobile nav click
    document.querySelectorAll("#sidebarNav .nav-link").forEach(link => {
      link.addEventListener("click", () => {
        if (window.innerWidth < 769) sidebar.classList.remove("open");
      });
    });
  </script>

  <!-- ====== Google Sign-In Logic (unchanged behavior) ====== -->
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const signInPage = document.getElementById("signInPage");
      const sidebar = document.getElementById("sidebar");
      const main = document.querySelector("main");
      const authSection = document.getElementById("authSection");

      function showSignIn(show) {
        signInPage.style.display = show ? "flex" : "none";
        sidebar.style.display = show ? "none" : "";
        main.style.display = show ? "none" : "";
        authSection.style.display = show ? "none" : "flex";
      }

      // Listen for auth state changes (your firebase.js should setup window.auth & googleProvider)
      if (window.auth && typeof window.auth.onAuthStateChanged === 'function') {
        window.auth.onAuthStateChanged(function(user) {
          if (user) {
            showSignIn(false);
            document.getElementById("loginBtn").style.display = "none";
            document.getElementById("userInfo").style.display = "flex";
            document.getElementById("userPhoto").src = user.photoURL;
            document.getElementById("userName").textContent = user.displayName;
          } else {
            showSignIn(true);
            document.getElementById("loginBtn").style.display = "";
            document.getElementById("userInfo").style.display = "none";
          }
        });
      }

      // Google sign-in from sign-in page
      document.getElementById("signInGoogleBtn").addEventListener("click", function() {
        window.auth.signInWithPopup(window.googleProvider).catch(function(error) {
          alert("Sign in failed: " + error.message);
        });
      });

      // Google sign-in from header
      document.getElementById("loginBtn").addEventListener("click", function() {
        window.auth.signInWithPopup(window.googleProvider).catch(function(error) {
          alert("Sign in failed: " + error.message);
        });
      });

      // Logout button
      document.getElementById("logoutBtn").addEventListener("click", function() {
        window.auth.signOut();
      });
    });
  </script>

</body>
</html>
